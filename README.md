# Scbackend

<div align="center">

![Scbackend Logo](https://img.shields.io/badge/Scbackend-v1.0.3-blue?style=for-the-badge)
![Node.js](https://img.shields.io/badge/Node.js-22.x-green?style=for-the-badge&logo=node.js)
![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)

**ä¸€ä¸ªé©å‘½æ€§çš„å°† Scratch ç”¨ä½œåç«¯å¼€å‘è¯­è¨€çš„åˆ›æ–°å¹³å°**

[English](docs/README-EN.md) | [æ¼”ç¤ºè§†é¢‘](#) | [åœ¨çº¿æ–‡æ¡£](#)

</div>

## ğŸš€ é¡¹ç›®ç®€ä»‹

Scbackend æ˜¯ä¸€ä¸ªçªç ´æ€§çš„å¼€å‘å¹³å°ï¼Œå®ƒå°†å¯è§†åŒ–ç¼–ç¨‹è¯­è¨€ Scratch è½¬æ¢ä¸ºå¼ºå¤§çš„åç«¯å¼€å‘å·¥å…·ã€‚é€šè¿‡é›†æˆçœŸå®çš„ Scratch VMï¼ˆè™šæ‹Ÿæœºï¼‰ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ç†Ÿæ‚‰çš„æ‹–æ‹½å¼ç¼–ç¨‹ç•Œé¢æ¥æ„å»ºå¤æ‚çš„åç«¯æœåŠ¡å’ŒAPIã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ¯ **å¯è§†åŒ–åç«¯å¼€å‘**: ä½¿ç”¨ Scratch ç§¯æœ¨å—æ„å»ºåç«¯é€»è¾‘
- ğŸ”§ **çœŸå® Scratch VM**: é›†æˆå®˜æ–¹ scratch-vm-developï¼Œç¡®ä¿å®Œæ•´å…¼å®¹æ€§
- ğŸŒ **ç°ä»£åŒ– Web ç•Œé¢**: å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒé¡¹ç›®ç®¡ç†å’Œå®æ—¶ç›‘æ§
- ğŸ” **å®Œæ•´è®¤è¯ç³»ç»Ÿ**: JWT token è®¤è¯ï¼Œæ”¯æŒç”¨æˆ·ç®¡ç†å’Œæƒé™æ§åˆ¶
- ğŸ“¡ **WebSocket å®æ—¶é€šä¿¡**: æ”¯æŒå®æ—¶æ•°æ®ä¼ è¾“å’ŒçŠ¶æ€åŒæ­¥
- ğŸ—„ï¸ **çµæ´»æ•°æ®å­˜å‚¨**: JSON æ–‡ä»¶å­˜å‚¨ï¼Œæ˜“äºéƒ¨ç½²å’Œç»´æŠ¤
- ğŸ”„ **é¡¹ç›®è¿è¡Œç®¡ç†**: æ”¯æŒé¡¹ç›®å¯åŠ¨ã€åœæ­¢ã€ç›‘æ§ç­‰å®Œæ•´ç”Ÿå‘½å‘¨æœŸç®¡ç†
- ğŸ›¡ï¸ **Node.js å…¼å®¹æ€§**: è‡ªåŠ¨å¤„ç† Worker polyfillï¼Œç¡®ä¿è·¨å¹³å°å…¼å®¹

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Scbackend æ¶æ„å›¾                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯ç•Œé¢ (Web UI)                                           â”‚
â”‚  â”œâ”€â”€ ç™»å½•/è®¤è¯é¡µé¢                                           â”‚
â”‚  â”œâ”€â”€ é¡¹ç›®ç®¡ç†æ§åˆ¶å°                                          â”‚
â”‚  â”œâ”€â”€ å®æ—¶çŠ¶æ€ç›‘æ§                                            â”‚
â”‚  â””â”€â”€ å¯†ç ç®¡ç†åŠŸèƒ½                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åç«¯æœåŠ¡ (Node.js + Express)                               â”‚
â”‚  â”œâ”€â”€ RESTful API æœåŠ¡                                       â”‚
â”‚  â”œâ”€â”€ WebSocket å®æ—¶é€šä¿¡                                     â”‚
â”‚  â”œâ”€â”€ JWT è®¤è¯ä¸­é—´ä»¶                                         â”‚
â”‚  â””â”€â”€ é¡¹ç›®è¿è¡Œç®¡ç†                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Scratch VM é›†æˆ                                            â”‚
â”‚  â”œâ”€â”€ çœŸå® Scratch è™šæ‹Ÿæœº                                    â”‚
â”‚  â”œâ”€â”€ æ‰©å±•ç®¡ç†å™¨                                              â”‚
â”‚  â”œâ”€â”€ Worker Polyfill (Node.js å…¼å®¹)                        â”‚
â”‚  â””â”€â”€ è‡ªå®šä¹‰ Scbackend æ‰©å±•                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å­˜å‚¨å±‚                                                  â”‚
â”‚  â”œâ”€â”€ JSON æ–‡ä»¶æ•°æ®åº“                                        â”‚
â”‚  â”œâ”€â”€ é¡¹ç›®é…ç½®å­˜å‚¨                                            â”‚
â”‚  â””â”€â”€ ç”¨æˆ·è®¤è¯æ•°æ®                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ å®‰è£…éƒ¨ç½²

### å‰ç½®é¡¹ç›®

- **Node.js**: ç‰ˆæœ¬ 18.x æˆ–æ›´é«˜ (æ¨è 22.x)
- **Git**: ç”¨äºå…‹éš†é¡¹ç›®ä»“åº“

### å¿«é€Ÿå¼€å§‹

#### æ–¹æ³•ä¸€ï¼šä»æºç å®‰è£…

```bash
# 1. å…‹éš†é¡¹ç›®ä»“åº“
git clone https://github.com/scbackend/scbackendd.git
cd scbackendd

# 2. å®‰è£…ä¾èµ–
npm install

# 3. å¯åŠ¨æœåŠ¡
npm start
```

#### æ–¹æ³•äºŒï¼šå…¨å±€å®‰è£…

```bash
# å…¨å±€å®‰è£…
npm install scbackendd --global

# åœ¨å·¥ä½œç›®å½•å¯åŠ¨
scbackendd
```

#### æ–¹æ³•ä¸‰ï¼šå¼€å‘æ¨¡å¼

```bash
# å…‹éš†å¹¶é“¾æ¥åˆ°å…¨å±€
git clone https://github.com/scbackend/scbackendd.git
cd scbackendd
npm link

# åœ¨ä»»æ„ç›®å½•å¯åŠ¨
scbackendd
```


## ğŸ–¥ï¸ ä½¿ç”¨æŒ‡å—

### 1. è®¿é—®ç®¡ç†ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://localhost:3030`

### 2. ç™»å½•ç³»ç»Ÿ

- **é»˜è®¤ç”¨æˆ·å**: `admin`
- **é»˜è®¤å¯†ç **: `admin123`
- âš ï¸ **é‡è¦**: é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç 

### 3. é¡¹ç›®ç®¡ç†

- **åˆ›å»ºé¡¹ç›®**: ç‚¹å‡»"åˆ›å»ºæ–°é¡¹ç›®"æŒ‰é’®
- **è¿è¡Œé¡¹ç›®**: é€‰æ‹©é¡¹ç›®åç‚¹å‡»"è¿è¡Œ"æŒ‰é’®
- **åœæ­¢é¡¹ç›®**: åœ¨è¿è¡ŒçŠ¶æ€ä¸‹ç‚¹å‡»"åœæ­¢"æŒ‰é’®
- **åˆ é™¤é¡¹ç›®**: é€‰æ‹©é¡¹ç›®åç‚¹å‡»"åˆ é™¤"æŒ‰é’®

### 4. å®æ—¶ç›‘æ§

- **è¿æ¥çŠ¶æ€**: æŸ¥çœ‹ WebSocket è¿æ¥çŠ¶æ€
- **é¡¹ç›®çŠ¶æ€**: å®æ—¶æ˜¾ç¤ºé¡¹ç›®è¿è¡ŒçŠ¶æ€
- **ç³»ç»Ÿæ—¥å¿—**: æŸ¥çœ‹è¯¦ç»†çš„ç³»ç»Ÿè¿è¡Œæ—¥å¿—

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½® (dbconfig.json)

```json
{
    "type": "json",
    "file": "projects.json"
}
```

### æœåŠ¡å™¨é…ç½®

- **HTTP ç«¯å£**: 3030
- **WebSocket ç«¯å£**: 3031
- **è®¤è¯æ–¹å¼**: JWT Token
- **æ•°æ®å­˜å‚¨**: JSON æ–‡ä»¶

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
scbackendd/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ index.js           # ä¸»å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ server.js          # Express æœåŠ¡å™¨
â”‚   â”œâ”€â”€ service.js         # æ ¸å¿ƒæœåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ runner.js          # é¡¹ç›®è¿è¡Œå™¨
â”‚   â”œâ”€â”€ vm-adapter.js      # Scratch VM é€‚é…å™¨
â”‚   â”œâ”€â”€ worker-polyfill.js # Worker å…¼å®¹æ€§è¡¥ä¸
â”‚   â”œâ”€â”€ auth.js            # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ middleware.js      # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ projects-simple.js # é¡¹ç›®æ•°æ®ç®¡ç†
â”‚   â””â”€â”€ logger.js          # æ—¥å¿—ç³»ç»Ÿ
â”œâ”€â”€ public/                # é™æ€èµ„æº
â”‚   â”œâ”€â”€ index.html         # ä¸»ç•Œé¢
â”‚   â””â”€â”€ login.html         # ç™»å½•é¡µé¢
â”œâ”€â”€ scratch-vm-develop/    # Scratch VM æºç 
â”œâ”€â”€ docs/                  # æ–‡æ¡£ç›®å½•
â””â”€â”€ test/                  # æµ‹è¯•æ–‡ä»¶
```

### API æ¥å£

#### è®¤è¯ç›¸å…³
- `POST /api/login` - ç”¨æˆ·ç™»å½•
- `POST /api/change-password` - ä¿®æ”¹å¯†ç 

#### é¡¹ç›®ç®¡ç†
- `GET /api/projects` - è·å–é¡¹ç›®åˆ—è¡¨
- `POST /api/projects` - åˆ›å»ºæ–°é¡¹ç›®
- `POST /api/projects/:id/run` - è¿è¡Œé¡¹ç›®
- `POST /api/projects/:id/stop` - åœæ­¢é¡¹ç›®
- `DELETE /api/projects/:id` - åˆ é™¤é¡¹ç›®

### æ‰©å±•å¼€å‘

Scbackend æ”¯æŒè‡ªå®šä¹‰æ‰©å±•å¼€å‘ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ·»åŠ æ–°åŠŸèƒ½ï¼š

```javascript
// ç¤ºä¾‹ï¼šè‡ªå®šä¹‰æ‰©å±•
class CustomExtension {
    getInfo() {
        return {
            id: 'customExtension',
            name: 'è‡ªå®šä¹‰æ‰©å±•',
            blocks: [
                {
                    opcode: 'customBlock',
                    blockType: 'command',
                    text: 'æ‰§è¡Œè‡ªå®šä¹‰æ“ä½œ'
                }
            ]
        };
    }
    
    customBlock() {
        console.log('æ‰§è¡Œè‡ªå®šä¹‰æ“ä½œ');
    }
}
```

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œé¡¹ç›®åŠŸèƒ½æµ‹è¯•
node test-project-run.js

# è¿è¡Œè®¤è¯æµ‹è¯•
node test-auth.js
```

### æµ‹è¯•è¦†ç›–

- âœ… ç”¨æˆ·è®¤è¯åŠŸèƒ½
- âœ… é¡¹ç›®åˆ›å»ºå’Œç®¡ç†
- âœ… é¡¹ç›®è¿è¡Œå’Œåœæ­¢
- âœ… WebSocket é€šä¿¡
- âœ… API æ¥å£å®Œæ•´æ€§

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. Worker is not defined é”™è¯¯
**è§£å†³æ–¹æ¡ˆ**: é¡¹ç›®å·²é›†æˆ Worker polyfillï¼Œè‡ªåŠ¨å¤„ç†æ­¤é—®é¢˜ã€‚

#### 2. ç«¯å£å ç”¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -an | findstr :3030
netstat -an | findstr :3031

# ç»ˆæ­¢å ç”¨è¿›ç¨‹
taskkill /f /pid <è¿›ç¨‹ID>
```

#### 3. é¡¹ç›®è¿è¡Œå¤±è´¥
- æ£€æŸ¥é¡¹ç›®é…ç½®æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ Scratch VM åˆå§‹åŒ–æˆåŠŸ
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯æ—¥å¿—

#### 4. è®¤è¯å¤±è´¥
- ç¡®è®¤ç”¨æˆ·åå¯†ç æ­£ç¡®
- æ£€æŸ¥ JWT token æ˜¯å¦æœ‰æ•ˆ
- é‡å¯æœåŠ¡é‡ç½®è®¤è¯çŠ¶æ€

### æ—¥å¿—åˆ†æ

ç³»ç»Ÿæä¾›è¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š
- `[INFO]` - ä¸€èˆ¬ä¿¡æ¯
- `[WARN]` - è­¦å‘Šä¿¡æ¯
- `[ERROR]` - é”™è¯¯ä¿¡æ¯


### å¼€å‘è§„èŒƒ

- ä½¿ç”¨ ES6+ è¯­æ³•
- éµå¾ª JSDoc æ³¨é‡Šè§„èŒƒ
- ä¿æŒä»£ç ç®€æ´å’Œå¯è¯»æ€§
- æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†
- ç¼–å†™ç›¸åº”çš„æµ‹è¯•ç”¨ä¾‹

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [Scratch](https://scratch.mit.edu/) - æä¾›äº†ä¼˜ç§€çš„å¯è§†åŒ–ç¼–ç¨‹å¹³å°
- [scratch-vm](https://github.com/scratchfoundation/scratch-vm) - Scratch è™šæ‹Ÿæœºæ ¸å¿ƒ
- [Node.js](https://nodejs.org/) - å¼ºå¤§çš„ JavaScript è¿è¡Œæ—¶
- [Express.js](https://expressjs.com/) - å¿«é€Ÿçš„ Web æ¡†æ¶

## æ›´æ–°æ—¥å¿—

- 2025-09-13 v1.0.3 - åˆå§‹ç‰ˆæœ¬

## ğŸ“ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**: [GitHub Repository](https://github.com/scbackend/scbackendd)
- **é—®é¢˜åé¦ˆ**: [Issues](https://github.com/scbackend/scbackendd/issues)
- **è®¨è®ºäº¤æµ**: [Discussions](https://github.com/scbackend/scbackendd/discussions)

---

<div align="center">

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼**


Made with â¤ï¸ by Scbackend Team

</div>